{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,yCAMMC,EAAU,IAAIC,eAAe,cAE7BC,EAAY,CAChBC,KAAMC,SAASC,cAAc,gBAC7BC,UAAWF,SAASC,cAAc,YAClCE,MAAOH,SAASC,cAAc,WAG5BG,EAAO,EACPC,EAAc,EAMZC,EAAW,IAAIC,sBA8DrB,SAAyBC,GACvBA,EAAQC,SAAQ,SAAAC,GACVA,EAAMC,iBACRP,GAAQ,GACR,EAAAQ,EAAAC,uBAAsBT,GACnBU,MAAK,SAAAC,GACJ,IAAAC,EAEID,EADFE,KAAQC,EAAIF,EAAJE,KAAMC,EAASH,EAATG,UAEhBrB,EAAUI,UAAUkB,mBAClB,aACA,EAAAC,EAAAC,cAAaJ,IAEftB,EAAQ2B,WACRlB,GAAea,EAAKM,SACDL,IACjBb,EAASmB,UAAU3B,EAAUK,OAC7BuB,EAAAhC,GAASiC,OAAOC,KACd,8D,IAILC,OAAM,SAAAC,G,OAASJ,EAAAhC,GAASiC,OAAOI,QAAQD,EAAME,Q,UAxFtC,CACdC,KAAM,KACNC,WAAY,UAIdpC,EAAUC,KAAKoC,iBAAiB,UAEhC,SAAuBC,GACrBA,EAAIC,iBACJvC,EAAUI,UAAUoC,UAAY,GAChC,IAAMC,EAAkBH,EAAII,cAAcC,SAAlCF,YAER,GAAiC,KAA7BA,EAAYG,MAAMC,OAEpB,YADAjB,EAAAhC,GAASiC,OAAOC,KAAK,6CAIvB,EAAAhB,EAAAgC,eAAcL,EAAYG,MAAOtC,GAC9BU,MAAK,SAAAC,GACJ,IAAAC,EAEID,EADFE,KAAQC,EAAIF,EAAJE,KAAMC,EAASH,EAATG,UAGI,IAAhBD,EAAKM,QAMTE,EAAAhC,GAASiC,OAAOkB,QAAQ,oBAA8BC,OAAV3B,EAAU,aACtDrB,EAAUI,UAAUkB,mBAAmB,aAAa,EAAAC,EAAAC,cAAaJ,IAEjEtB,EAAQ2B,WACRlB,GAAea,EAAKM,QAEFL,GAChBb,EAASyC,QAAQjD,EAAUK,QAZ3BuB,EAAAhC,GAASiC,OAAOI,QACd,2E,IAcLF,OAAM,SAAAC,G,OAASJ,EAAAhC,GAASiC,OAAOI,QAAQD,EAAME,Q","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createMarkup } from './fn-createmarkup';\nimport { serviceSearch, serviceSearchLoadMore } from './fn-request-api';\n\nconst gallery = new SimpleLightbox('.gallery a');\n\nconst selectors = {\n  form: document.querySelector('.search-form'),\n  container: document.querySelector('.gallery'),\n  guard: document.querySelector('.guard'),\n};\n\nlet page = 1;\nlet hitsCounter = 0;\n\nconst options = {\n  root: null,\n  rootMargin: '300px',\n};\nconst observer = new IntersectionObserver(handlerLoadMore, options);\n\nselectors.form.addEventListener('submit', handlerSearch);\n\nfunction handlerSearch(evt) {\n  evt.preventDefault();\n  selectors.container.innerHTML = '';\n  const { searchQuery } = evt.currentTarget.elements;\n\n  if (searchQuery.value.trim() === '') {\n    Notiflix.Notify.info('Please enter the details of your request');\n    return;\n  }\n\n  serviceSearch(searchQuery.value, page)\n    .then(response => {\n      const {\n        data: { hits, totalHits },\n      } = response;\n\n      if (hits.length === 0) {\n        Notiflix.Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n      Notiflix.Notify.success(`Hooray! We found ${totalHits} images\"`);\n      selectors.container.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n      gallery.refresh();\n      hitsCounter += hits.length;\n\n      if (hitsCounter < totalHits) {\n        observer.observe(selectors.guard);\n      }\n    })\n    .catch(error => Notiflix.Notify.failure(error.message));\n}\n\n// function handlerLoadMore() {\n//   page += 1;\n//   serviceSearchLoadMore(page)\n//     .then(response => {\n//       const {\n//         data: { hits, totalHits },\n//       } = response;\n\n//       selectors.container.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n//       gallery.refresh();\n//       hitsCounter += hits.length;\n\n//       if (hitsCounter >= totalHits) {\n//         observer.unobserve(selectors.guard);\n//         Notiflix.Notify.info(\n//           \"We're sorry, but you've reached the end of search results.\"\n//         );\n//       }\n//     })\n//     .catch(error => Notiflix.Notify.failure(error.message));\n// }\n\nfunction handlerLoadMore(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      page += 1;\n      serviceSearchLoadMore(page)\n        .then(response => {\n          const {\n            data: { hits, totalHits },\n          } = response;\n          selectors.container.insertAdjacentHTML(\n            'beforeend',\n            createMarkup(hits)\n          );\n          gallery.refresh();\n          hitsCounter += hits.length;\n          if (hitsCounter >= totalHits) {\n            observer.unobserve(selectors.guard);\n            Notiflix.Notify.info(\n              \"We're sorry, but you've reached the end of search results.\"\n            );\n          }\n        })\n        .catch(error => Notiflix.Notify.failure(error.message));\n    }\n  });\n}\n"],"names":["$6JpON","parcelRequire","$93b54f497d416715$var$gallery","SimpleLightbox","$93b54f497d416715$var$selectors","form","document","querySelector","container","guard","$93b54f497d416715$var$page","$93b54f497d416715$var$hitsCounter","$93b54f497d416715$var$observer","IntersectionObserver","entries","forEach","entry","isIntersecting","$bu6fV","serviceSearchLoadMore","then","response","_data","data","hits","totalHits","insertAdjacentHTML","$4AS3O","createMarkup","refresh","length","unobserve","$parcel$interopDefault","Notify","info","catch","error","failure","message","root","rootMargin","addEventListener","evt","preventDefault","innerHTML","searchQuery","currentTarget","elements","value","trim","serviceSearch","success","concat","observe"],"version":3,"file":"infinite-scroll.3d6a735c.js.map"}