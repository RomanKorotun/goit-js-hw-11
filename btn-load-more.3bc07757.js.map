{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,yCAMMC,EAAU,IAAIC,eAAe,cAE7BC,EAAY,CAChBC,KAAMC,SAASC,cAAc,gBAC7BC,MAAOF,SAASC,cAAc,sBAC9BE,UAAWH,SAASC,cAAc,YAClCG,YAAaJ,SAASC,cAAc,kBAGlCI,EAAO,EACPC,EAAc,EAElBR,EAAUC,KAAKQ,iBAAiB,UAGhC,SAAuBC,GAKrB,GAJAA,EAAIC,iBACJX,EAAUK,UAAUO,UAAY,GAChCZ,EAAUM,YAAYO,UAAUC,QAAQ,YAAa,oBAEhB,KAAjCd,EAAUI,MAAMW,MAAMC,OAExB,YADAC,EAAArB,GAASsB,OAAOC,KAAK,4CAIvBZ,EAAO,GAEP,EAAAa,EAAAC,eAAcrB,EAAUI,MAAMW,MAAQO,YAAc,KACjDC,MAAK,SAAAC,GACJ,IAAAC,EAEID,EADFE,KAAQC,EAAIF,EAAJE,KAAMC,EAASH,EAATG,UAEI,IAAhBD,EAAKE,QAMTZ,EAAArB,GAASsB,OAAOY,QAAQ,oBAA8BC,OAAVH,EAAU,aACtD5B,EAAUK,UAAU2B,mBAAmB,aAAa,EAAAC,EAAAC,cAAaP,IAEjE7B,EAAQqC,WACR3B,GAAemB,EAAKE,QAEFD,GAChB5B,EAAUM,YAAYO,UAAUC,QAC9B,mBACA,cAdFG,EAAArB,GAASsB,OAAOkB,QACd,2E,IAiBLC,OAAM,SAAAC,G,OAASrB,EAAArB,GAASsB,OAAOkB,QAAQE,EAAMC,Q,OAtClDvC,EAAUM,YAAYG,iBAAiB,SAyCvC,WACEF,GAAQ,GACR,EAAAa,EAAAC,eAAcrB,EAAUI,MAAMW,MAAOR,GAClCgB,MAAK,SAAAC,GACJ,IAAAC,EAEID,EADFE,KAAQC,EAAIF,EAAJE,KAAMC,EAASH,EAATG,UAEhB,GAAoB,IAAhBD,EAAKE,OAAT,CAMA7B,EAAUK,UAAU2B,mBAAmB,aAAa,EAAAC,EAAAC,cAAaP,IAEjE,IAAQa,EACNxC,EAAUK,UAAUoC,kBAAkBC,wBADhCC,OAERC,OAAOC,SAAS,CACdC,IAAkB,IAAbN,EACLO,SAAU,WAGZjD,EAAQqC,WACR3B,GAAemB,EAAKE,SAEDD,IACjB5B,EAAUM,YAAYO,UAAUC,QAC9B,YACA,oBAEFG,EAAArB,GAASsB,OAAOC,KACd,8D,MAvBFF,EAAArB,GAASsB,OAAOkB,QACd,2E,IA0BLC,OAAM,SAAAC,G,OAASrB,EAAArB,GAASsB,OAAOkB,QAAQE,EAAMC,Q","sources":["src/js/btn-load-more.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createMarkup } from './fn-createmarkup';\nimport { serviceSearch } from './fn-request-api';\n\nconst gallery = new SimpleLightbox('.gallery a');\n\nconst selectors = {\n  form: document.querySelector('.search-form'),\n  input: document.querySelector('.search-form-input'),\n  container: document.querySelector('.gallery'),\n  btnLoadMore: document.querySelector('.js-load-more'),\n};\n\nlet page = 1;\nlet hitsCounter = 0;\n\nselectors.form.addEventListener('submit', handlerSearch);\nselectors.btnLoadMore.addEventListener('click', handlerLoadMore);\n\nfunction handlerSearch(evt) {\n  evt.preventDefault();\n  selectors.container.innerHTML = '';\n  selectors.btnLoadMore.classList.replace('load-more', 'load-more-hidden');\n\n  if (selectors.input.value.trim() === '') {\n    Notiflix.Notify.info('Please enter the details of your request');\n    return;\n  }\n\n  page = 1;\n\n  serviceSearch(selectors.input.value, (currentPage = '1'))\n    .then(response => {\n      const {\n        data: { hits, totalHits },\n      } = response;\n      if (hits.length === 0) {\n        Notiflix.Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n      Notiflix.Notify.success(`Hooray! We found ${totalHits} images\"`);\n      selectors.container.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n      gallery.refresh();\n      hitsCounter += hits.length;\n\n      if (hitsCounter < totalHits) {\n        selectors.btnLoadMore.classList.replace(\n          'load-more-hidden',\n          'load-more'\n        );\n      }\n    })\n    .catch(error => Notiflix.Notify.failure(error.message));\n}\n\nfunction handlerLoadMore() {\n  page += 1;\n  serviceSearch(selectors.input.value, page)\n    .then(response => {\n      const {\n        data: { hits, totalHits },\n      } = response;\n      if (hits.length === 0) {\n        Notiflix.Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n      selectors.container.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n      const { height: cardHeight } =\n        selectors.container.firstElementChild.getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 1.6,\n        behavior: 'smooth',\n      });\n\n      gallery.refresh();\n      hitsCounter += hits.length;\n\n      if (hitsCounter >= totalHits) {\n        selectors.btnLoadMore.classList.replace(\n          'load-more',\n          'load-more-hidden'\n        );\n        Notiflix.Notify.info(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n    })\n    .catch(error => Notiflix.Notify.failure(error.message));\n}\n"],"names":["$6JpON","parcelRequire","$1ca60b32740dbd18$var$gallery","SimpleLightbox","$1ca60b32740dbd18$var$selectors","form","document","querySelector","input","container","btnLoadMore","$1ca60b32740dbd18$var$page","$1ca60b32740dbd18$var$hitsCounter","addEventListener","evt","preventDefault","innerHTML","classList","replace","value","trim","$parcel$interopDefault","Notify","info","$bu6fV","serviceSearch","currentPage","then","response","_data","data","hits","totalHits","length","success","concat","insertAdjacentHTML","$4AS3O","createMarkup","refresh","failure","catch","error","message","cardHeight","firstElementChild","getBoundingClientRect","height","window","scrollBy","top","behavior"],"version":3,"file":"btn-load-more.3bc07757.js.map"}